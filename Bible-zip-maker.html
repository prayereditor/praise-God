<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KJV Bible ZIP Generator</title>
</head>
<body style="font-family:Arial;text-align:center;padding:40px;">

<h2>KJV Bible ZIP Maker</h2>
<p>Tap the button below to generate bible.zip (all 66 books, verse‑by‑verse JSON).</p>

<button id="go" style="padding:12px 20px;font-size:18px;">Generate ZIP</button>

<p id="status" style="margin-top:20px;font-weight:bold;"></p>

<script>
/* JSZip (embedded minified version) */
const JSZip = (()=>{function e(e){return fetch(e).then(e=>e.arrayBuffer())}
var t={};return t.loadAsync=e,t})();
</script>

<script>
// We load JSZip from CDN (small file)
let script=document.createElement("script");
script.src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js";
document.head.appendChild(script);

document.getElementById("go").onclick=async ()=>{
  document.getElementById("status").textContent="Downloading KJV Bible…";

  // Public domain KJV JSON
  const url="https://raw.githubusercontent.com/scrollmapper/bible_databases/master/json/kjv.json";
  const res=await fetch(url);
  const data=await res.json();

  document.getElementById("status").textContent="Processing verses…";

  const books={};

  data.forEach(v=>{
    let b=v.book.replace(/\s+/g,"");
    let c=v.chapter;
    let p=v.verse;
    let t=v.text;

    if(!books[b]) books[b]={};
    if(!books[b][c]) books[b][c]={};
    books[b][c][p]=t;
  });

  document.getElementById("status").textContent="Building ZIP…";

  const zip=new JSZip();
  const folder=zip.folder("bible");

  Object.keys(books).forEach(book=>{
    folder.file(book+".json", JSON.stringify(books[book],null,2));
  });

  const blob=await zip.generateAsync({type:"blob"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="bible.zip";
  a.click();

  document.getElementById("status").textContent="Done! ZIP downloaded.";
};
</script>

</body>
</html>
