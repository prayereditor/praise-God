<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>I‚Äôm Fine ‚Äî Leave.</title>

<style>
  body {
    background: black;
    color: red;
    font-family: "Courier New", monospace;
    text-align: center;
    padding: 40px;
    overflow-x: hidden;
    transition: background 0.3s ease;
  }

  .warningBtn {
    padding: 15px 25px;
    background: darkred;
    color: white;
    border: none;
    font-size: 20px;
    cursor: pointer;
    margin: 20px auto;
    display: block;
    width: 80%;
    max-width: 320px;
  }

  .warningBtn:hover { background: red; }

  #msgBox {
    position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
    background: rgba(20,0,0,0.8);
    padding: 10px 20px;
    color: red;
    border: 1px solid red;
    font-size: 18px;
    opacity: 0;
    transition: opacity 0.4s ease;
    pointer-events: none;
  }

  .scareScreen {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: black; color: darkred;
    font-size: 42px;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 20px; text-align: center;
    white-space: pre-line;
    opacity: 0; pointer-events: none;
    transition: opacity 1s ease;
    z-index: 999998;
  }

  .backBtn {
    margin-top: 40px;
    padding: 12px 20px;
    background: darkred;
    color: white;
    border: none;
    font-size: 20px;
    display: none;
  }

  #demonFlash {
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: white;
    opacity: 0; pointer-events: none;
    transition: opacity 0.05s ease;
    z-index: 3000000;
  }

  #cornerShadow {
    position: fixed; bottom: 0; right: 0;
    width: 140px; height: 280px;
    background: rgba(0,0,0,0.7);
    opacity: 0; pointer-events: none;
    transition: opacity 0.4s ease;
    z-index: 999999;
    clip-path: polygon(100% 0, 100% 100%, 0 100%);
  }

  #blackoutScreen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: black; color: white;
    font-size: 40px; opacity: 0;
    display: flex; justify-content: center; align-items: center;
    pointer-events: none;
    z-index: 5000000;
    transition: opacity 0.4s ease;
  }

  .glitch { animation: glitch 0.3s infinite; }
  @keyframes glitch {
    0% { text-shadow: 3px 3px red; }
    50% { text-shadow: -3px -3px #800; }
    100% { text-shadow: 2px -2px darkred; }
  }

  #eyes {
    position: fixed;
    top: 20%;
    left: 50%;
    transform: translateX(-50%);
    font-size: 60px;
    opacity: 0;
    transition: opacity 1s linear;
    letter-spacing: 40px;
    z-index: 9999999;
  }

  #demonSilhouette {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: radial-gradient(circle at center, transparent 0%, transparent 40%, rgba(0,0,0,0.8) 100%);
    opacity: 0; pointer-events: none;
    z-index: 9000000;
    transition: opacity 3s ease;
  }

  #cameraWarning {
    position: fixed;
    top: 10%; left: 50%;
    transform: translateX(-50%);
    color: white;
    background: rgba(255,0,0,0.2);
    border: 1px solid red;
    padding: 20px;
    font-size: 30px;
    opacity: 0; pointer-events: none;
    transition: opacity 1s ease;
    z-index: 9999999;
  }

  #globalBack {
    position: fixed;
    bottom: 25px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(50,0,0,0.8);
    padding: 14px 28px;
    border-radius: 40px;
    color: white;
    font-size: 18px;
    border: 1px solid red;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
    z-index: 90000000;
  }

  #walkerShadow {
    position: fixed;
    bottom: 0;
    left: -200px;
    width: 200px;
    height: 400px;
    background: rgba(0,0,0,0.85);
    opacity: 0;
    transition: transform 4s linear, opacity 1s ease;
    z-index: 999999;
  }

  #glitchOverlay {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:white;
    mix-blend-mode:difference;
    opacity:0;
    z-index:9999999;
    pointer-events:none;
    transition:opacity 0.1s ease;
  }

  /* ------------------------------
     NEW: Horror Name Popup
  ------------------------------ */
  #namePopupBg {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    background: rgba(0,0,0,0.85);
    backdrop-filter: blur(4px);
    display:flex; justify-content:center; align-items:center;
    z-index: 99999999;
    opacity:0; pointer-events:none;
    transition: opacity 0.5s ease;
  }
  #namePopup {
    background: rgba(20,0,0,0.9);
    border:1px solid red;
    padding:30px;
    width:80%;
    max-width:340px;
    text-align:center;
    color:red;
    box-shadow:0 0 20px red;
    animation: flicker 1.4s infinite;
  }
  @keyframes flicker {
    0% {opacity:1;}
    50% {opacity:0.8;}
    100% {opacity:1;}
  }
  #nameInput {
    width:90%;
    padding:10px;
    background:black;
    border:1px solid red;
    color:white;
    margin-top:15px;
    text-align:center;
    font-size:18px;
  }
  #nameSubmit {
    margin-top:20px;
    padding:10px 20px;
    background:darkred;
    color:white;
    border:none;
    cursor:pointer;
    font-size:18px;
    width:100%;
  }
  #nameSubmit:hover { background:red; }
</style>
</head>

<body>

<h1 class="glitch">Do NOT press any buttons.</h1>

<!-- Buttons -->
<button id="btn1" class="warningBtn">DON'T PRESS THIS</button>
<button id="btn2" class="warningBtn">DO NOT LOOK HERE</button>
<button id="btn3" class="warningBtn">SERIOUSLY, STOP</button>
<button id="btnAI" class="warningBtn">Do you want to know how I feel?</button>
<button id="btnKnow" class="warningBtn">I know you‚Ä¶</button>

<div id="msgBox"></div>

<!-- Screens -->
<div id="dareScreen"    class="scareScreen"><span>HOW DARE YOU</span><button class="backBtn">Go Back</button></div>
<div id="warnScreen"    class="scareScreen"><span>I WARNED YOU</span><button class="backBtn">Go Back</button></div>
<div id="stopScreen"    class="scareScreen"><span>YOU NEVER LISTEN</span><button class="backBtn">Go Back</button></div>
<div id="presenceScreen"class="scareScreen"><span>WHY ARE YOU STILL HERE?</span><button class="backBtn">Go Back</button></div>
<div id="delayedScreen" class="scareScreen"><span>YOU SHOULDN‚ÄôT HAVE STAYED THIS LONG</span><button class="backBtn">Go Back</button></div>
<div id="aiScreen"      class="scareScreen"><span>SYSTEM STATUS: NOT STABLE</span><button class="backBtn">Go Back</button></div>

<div id="knowScreen" class="scareScreen">
  <span id="knowText"></span>
  <button class="backBtn">Go Back</button>
</div>

<div id="terminalScreen" class="scareScreen">
  <span id="terminalText"></span>
  <button class="backBtn">Go Back</button>
</div>

<div id="nameScreen" class="scareScreen">
  <span id="nameText">Isn‚Äôt your name‚Ä¶  
  <span id="fakeGuess" style="color:white;"></span>?</span>
  <button class="backBtn">Go Back</button>
</div>

<!-- Effects -->
<div id="cornerShadow"></div>
<div id="demonFlash"></div>
<div id="blackoutScreen">system integrity compromised</div>
<div id="eyes">üëÅÔ∏è üëÅÔ∏è</div>
<div id="demonSilhouette"></div>
<div id="cameraWarning">Camera Active‚Ä¶</div>
<div id="globalBack">Back</div>
<div id="walkerShadow"></div>
<div id="glitchOverlay"></div>

<!-- NAME POPUP -->
<div id="namePopupBg">
  <div id="namePopup">
    <h2>What's your name?</h2>
    <input id="nameInput" placeholder="e.g., Mr. Steven">
    <button id="nameSubmit">Continue</button>
  </div>
</div>

<script>

/* --------------------------------------------------------
      NEW: Name popup system + saving + validation
--------------------------------------------------------- */

let userName = null;

function capitalizeName(n){
  return n
    .split(" ")
    .filter(w => w.trim().length > 0)
    .map(w => w[0].toUpperCase() + w.slice(1).toLowerCase())
    .join(" ");
}

function validName(n){
  return /^[A-Za-z .'-]{2,40}$/.test(n.trim());
}

function openPopup(){
  const bg = document.getElementById("namePopupBg");
  bg.style.opacity = 1;
  bg.style.pointerEvents = "all";
}

function closePopup(){
  const bg = document.getElementById("namePopupBg");
  bg.style.opacity = 0;
  bg.style.pointerEvents = "none";
}

function setName(n){
  userName = n;
  localStorage.setItem("horrorName", n);
  document.getElementById("fakeGuess").innerText = n;
  document.getElementById("knowText").innerText = "I already knew your name, " + n + ".";
}

/* On page load */
window.onload = function(){
  let saved = localStorage.getItem("horrorName");
  if(saved){
    userName = saved;
    setName(saved);
  }
  else {
    openPopup();
  }
};

/* popup button */
document.getElementById("nameSubmit").onclick = function(){
  let val = document.getElementById("nameInput").value.trim();
  if(!validName(val)){
    alert("Enter a real name (letters only).");
    return;
  }
  val = capitalizeName(val);
  setName(val);
  closePopup();
};

/* -----------------------------
   Existing Functions
----------------------------- */

function showMsg(t){
  const m=document.getElementById("msgBox");
  m.innerText=t;
  m.style.opacity=1;
  setTimeout(()=>m.style.opacity=0,2500);
}

function showScare(id,text){
  const s=document.getElementById(id);
  if(text) s.querySelector("span").innerText = text;
  s.style.opacity=1;
  s.style.pointerEvents="all";
  s.querySelector(".backBtn").style.display="block";
}

function hideScare(id){
  const s=document.getElementById(id);
  s.style.opacity=0;
  s.style.pointerEvents="none";
}

document.querySelectorAll(".backBtn").forEach(btn=>{
  btn.onclick = (e)=>{
    hideScare(e.target.parentElement.id);
  };
});

function activateGlobalBack(){
  const b=document.getElementById("globalBack");
  b.style.opacity=1;
  b.style.pointerEvents="auto";
}

btn1.onclick=()=>{ showScare("dareScreen","How dare you, "+userName); activateGlobalBack(); };
btn2.onclick=()=>{ showScare("warnScreen","You were told not to look, "+userName); activateGlobalBack(); };
btn3.onclick=()=>{ showScare("stopScreen","You never listen, "+userName); activateGlobalBack(); };
btnAI.onclick=()=>{ showScare("aiScreen","SYSTEM FAILURE\n"+userName+", step away."); activateGlobalBack(); };
btnKnow.onclick=()=>{ showScare("nameScreen"); activateGlobalBack(); };

document.getElementById("globalBack").onclick=()=>{
  document.querySelectorAll(".scareScreen").forEach(s=>{
    s.style.opacity=0;
    s.style.pointerEvents="none";
  });
};

/* Cursor shake */
function cursorShake(){
  if(Math.random()<0.1){
    document.body.style.cursor="none";
    setTimeout(()=>document.body.style.cursor="default",250);
  }
  setTimeout(cursorShake,3000);
}
cursorShake();

/* Scroll lock */
let lock=false;
window.addEventListener("scroll",()=>{
  if(!lock && Math.random()<0.1){
    lock=true;
    document.body.style.overflow="hidden";
    showMsg("Stop struggling, "+userName+".");
    setTimeout(()=>{
      document.body.overflow="auto";
      lock=false;
    },2000);
  }
});

/* Flash */
setTimeout(()=>{
  const d=document.getElementById("demonFlash");
  d.style.opacity=1;
  setTimeout(()=>d.style.opacity=0,50);
}, Math.random()*12000+8000);

/* Shadow */
setInterval(()=>{
  if(Math.random()<0.15){
    const c=document.getElementById("cornerShadow");
    c.style.opacity=1;
    setTimeout(()=>c.style.opacity=0,1200);
  }
},7000);

/* Blackout */
setTimeout(()=>{
  const b=document.getElementById("blackoutScreen");
  b.style.opacity=1;
  setTimeout(()=>b.style.opacity=0,2500);
},45000);

/* Idle presence */
let lastMove=Date.now();
document.addEventListener("mousemove",()=>lastMove=Date.now());
setInterval(()=>{
  if(Date.now()-lastMove>4000){
    showScare("presenceScreen","I'm right behind you, "+userName+".");
    activateGlobalBack();
  }
},3000);

/* Terminal */
setTimeout(()=>{
  const t=document.getElementById("terminalText");
  const s=document.getElementById("terminalScreen");
  let text="ACCESSING MEMORY NODE‚Ä¶\n...\nYou ignored me last time, "+userName+".";
  let i=0;

  s.style.opacity=1;
  function type(){
    t.innerText=text.slice(0,i);
    i++;
    if(i<=text.length) setTimeout(type,60);
  }
  type();
},60000);

/* Eyes */
setInterval(()=>{
  const e=document.getElementById("eyes");
  if(Math.random()<0.15){
    e.style.opacity=1;
    e.style.transform="translateX("+(Math.random()*60-30)+"px)";
    setTimeout(()=>e.style.opacity=0,2000);
  }
},7000);

/* Taps */
function playTap(){
  const ctx = new AudioContext();
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.frequency.value=800;
  g.gain.value=0.1;
  o.connect(g); g.connect(ctx.destination);
  o.start(); o.stop(ctx.currentTime+0.05);
}
setInterval(()=>{ if(Math.random()<0.1) playTap(); },5000);

/* Footsteps */
function playFootstep(){
  const ctx = new AudioContext();
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.frequency.value=50;
  g.gain.setValueAtTime(0.2,ctx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.4);
  o.connect(g); g.connect(ctx.destination);
  o.start(); o.stop(ctx.currentTime+0.4);
}
setInterval(()=>{ if(Math.random()<0.08) playFootstep(); },7000);

/* Fake camera */
setTimeout(()=>{
  const cam=document.getElementById("cameraWarning");
  cam.style.opacity=1;
  setTimeout(()=>cam.style.opacity=0,6000);
},35000);

/* Silhouette */
setTimeout(()=>{
  const s=document.getElementById("demonSilhouette");
  s.style.opacity=1;
  setTimeout(()=>s.style.opacity=0,6000);
},50000);

/* Whispers */
function playWhisper(){
  const ctx=new AudioContext();
  const buffer=ctx.createBuffer(1,44100,44100);
  const data=buffer.getChannelData(0);
  for(let i=0;i<data.length;i++) data[i]=(Math.random()*2-1)*0.03;
  const src=ctx.createBufferSource();
  src.buffer=buffer;
  const gain=ctx.createGain();
  gain.gain.value=0.1;
  src.connect(gain); gain.connect(ctx.destination);
  src.start();
}
setInterval(()=>{ if(Math.random()<0.07) playWhisper(); },6000);

/* Breathing */
function playBreathing(){
  const ctx=new AudioContext();
  const o=ctx.createOscillator();
  const g=ctx.createGain();
  o.frequency.value=20;
  g.gain.value=0.001;
  g.gain.exponentialRampToValueAtTime(0.03,ctx.currentTime+1.5);
  g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+3);
  o.connect(g); g.connect(ctx.destination);
  o.start();
  o.stop(ctx.currentTime+3);
}
setInterval(()=>{ if(Math.random()<0.06) playBreathing(); },8000);

/* Heartbeat */
function playHeartbeat(){
  const ctx=new AudioContext();
  const o=ctx.createOscillator();
  const g=ctx.createGain();
  o.frequency.value=60;
  g.gain.value=0.3;
  g.gain.exponentialRampToValueAtTime(0.01,ctx.currentTime+0.2);
  o.connect(g); g.connect(ctx.destination);
  o.start(); o.stop(ctx.currentTime+0.2);
}
setInterval(()=>{ if(Math.random()<0.05) playHeartbeat(); },3000);

/* Shadow walker */
setInterval(()=>{
  if(Math.random()<0.08){
    const w=document.getElementById("walkerShadow");
    w.style.opacity=1;
    w.style.transform="translateX(150vw)";
    setTimeout(()=>{
      w.style.opacity=0;
      w.style.transform="translateX(-200px)";
    },4000);
  }
},9000);

/* Glitch bursts */
function glitchBurst(){
  const g=document.getElementById("glitchOverlay");
  g.style.opacity=1;
  setTimeout(()=>g.style.opacity=0,80);
}
setInterval(()=>{ if(Math.random()<0.1) glitchBurst(); },5000);

</script>
</body>
</html>
